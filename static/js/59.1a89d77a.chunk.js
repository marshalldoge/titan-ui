(this["webpackJsonptitan-ui"]=this["webpackJsonptitan-ui"]||[]).push([[59],{768:function(e,a,t){"use strict";t.r(a);var n=t(14),r=t(58),s=t(59),o=t(87),i=t(62),u=t(61),c=t(0),l=t.n(c),p=t(10),h=t(185),m=t(509),d=t(510),v=t(21),f=(t(73),t(769),t(22)),C=t(79),g=l.a.lazy((function(){return Promise.all([t.e(0),t.e(10)]).then(t.bind(null,231))})),E=l.a.lazy((function(){return Promise.all([t.e(0),t.e(9)]).then(t.bind(null,155))})),y=function(e){Object(i.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(r.a)(this,t);for(var s=arguments.length,i=new Array(s),u=0;u<s;u++)i[u]=arguments[u];return(e=a.call.apply(a,[this].concat(i))).state={code:"",name:"",conversion:"",salePrice:"",purchasePrice:"",minPrice:"",description:"",warehouses:[],parsedConversion:[]},e.saveManual=function(){var a={"Content-Type":"application/json; charset=utf-8",Authorization:Object(v.b)("JWT")},t=(Object(o.a)(e),JSON.stringify({code:e.state.code,name:e.state.name,description:e.state.description,conversion:e.state.conversion,idCompany:e.props.idCompany,salePrice:parseFloat(e.state.salePrice),purchasePrice:parseFloat(e.state.purchasePrice),minPrice:parseFloat(e.state.minPrice),warehouseItemQuantities:e.state.warehouses.map((function(e){return{name:e.name,idWarehouse:e.idWarehouse,quantity:""===e.quantity?0:e.quantity,idMeasure:e.idMeasure}}))})),n=Object(v.k)(C.a+"/Item",{});fetch(n,{method:"POST",headers:a,body:t}).then((function(e){return e.json()})).then((function(e){e.success&&h.b.success("El producto se ha creado satisfactoriamente.")})).catch((function(e){console.log(e)}))},e.handleChange=function(a){e.setState(Object(n.a)({},a.target.name,a.target.value))},e.handleWarehouseInputChange=function(a){var t=a.target.id,n=a.target.name,r=a.target.value;e.setState((function(e){return e.warehouses[t][n]=r,e}))},e.handleWarehouseMeasureChange=function(a){var t=a.target.id,n=a.target.name,r=a.target.value;e.setState((function(a){return a.warehouses[t][n]=e.props.nameIdMeasureHashMap[r],a}))},e.parseConversion=function(){var a=Object(o.a)(e);e.setState((function(e){e.parsedConversion=e.conversion.split("x");for(var t=function(t){for(var n=0;n<e.parsedConversion[t].length;n++)if(Object(v.g)(e.parsedConversion[t].charAt(n))){e.parsedConversion[t]=e.parsedConversion[t].substr(n,e.parsedConversion[t].length);break}0===t&&(e.warehouses=e.warehouses.map((function(n){return console.log("Warehouse: ",n),{name:n.name,idWarehouse:n.idWarehouse,quantity:"",idMeasure:a.props.nameIdMeasureHashMap[e.parsedConversion[t]]}})))},n=0;n<e.parsedConversion.length;n++)t(n);return console.log("Final state after parsing: ",e),e}))},e.MeasureSelect=function(a){for(var t=[],n=0;n<e.state.parsedConversion.length;n++)t.push(l.a.createElement("option",{key:n,value:e.state.parsedConversion[n]},e.state.parsedConversion[n]));return l.a.createElement("select",{id:a,name:"idMeasure",value:e.state.warehouses[a].measure,onChange:e.handleWarehouseMeasureChange},t)},e.WarehouseInputs=function(){for(var a=[],t=0;t<e.state.warehouses.length;t++)a.push(l.a.createElement("div",{key:t},l.a.createElement(m.a,{type:"flex",justify:"space-between"},l.a.createElement(d.a,{span:6},l.a.createElement("p",null,e.state.warehouses[t].name)),l.a.createElement(d.a,{span:10},l.a.createElement("input",{id:t,name:"quantity",className:"input",type:"text",value:e.state.warehouses[t].quantity,placeholder:0,onChange:e.handleWarehouseInputChange})),l.a.createElement(d.a,{span:4},e.MeasureSelect(t))),l.a.createElement("br",null)));return l.a.createElement(m.a,null,a)},e.saveItemButton=function(){return l.a.createElement(E,{label:"Mover Items",size:"small",onClick:e.saveManual,type:"inverse"})},e}return Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,a=function(a){e.props.nameIdWarehouseHashMap.hasOwnProperty(a)&&e.setState((function(t){return t.warehouses.push({name:a,idWarehouse:e.props.nameIdWarehouseHashMap[a],quantity:"",idMeasure:0}),t}))};for(var t in this.props.nameIdWarehouseHashMap)a(t)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement(m.a,null,l.a.createElement(g,{label:"Datos del producto:",size:"medium"})),l.a.createElement("br",null),l.a.createElement(m.a,{type:"flex",justify:"space-between"},l.a.createElement(d.a,{span:8},l.a.createElement("input",{name:"code",className:"input",type:"text",value:this.state.code,placeholder:"C\xf3digo",onChange:this.handleChange})),l.a.createElement(d.a,{span:8},l.a.createElement("input",{name:"name",className:"input",type:"text",value:this.state.name,placeholder:"Nombre",onChange:this.handleChange})),l.a.createElement(d.a,{span:8},l.a.createElement("input",{name:"conversion",className:"input",type:"text",value:this.state.conversion,placeholder:"Conversi\xf3n",onChange:function(a){e.handleChange(a),e.parseConversion()}}))),l.a.createElement("br",null),l.a.createElement(m.a,{type:"flex",justify:"space-between"},l.a.createElement(d.a,{span:8},l.a.createElement("input",{name:"salePrice",className:"input",type:"text",value:this.state.salePrice,placeholder:"Precio Venta",onChange:this.handleChange})),l.a.createElement(d.a,{span:8},l.a.createElement("input",{name:"purchasePrice",className:"input",type:"text",value:this.state.purchasePrice,placeholder:"Precio Compra",onChange:this.handleChange})),l.a.createElement(d.a,{span:8},l.a.createElement("input",{name:"minPrice",className:"input",type:"text",value:this.state.minPrice,placeholder:"Precio m\xednimo",onChange:this.handleChange}))),l.a.createElement("br",null),l.a.createElement(m.a,{type:"flex",justify:"space-between"},l.a.createElement(d.a,{span:24},l.a.createElement("textarea",{name:"description",className:"input despcription",value:this.state.description,placeholder:"Descripci\xf3n",onChange:this.handleChange,cols:"40",rows:"6"}))),l.a.createElement("br",null),l.a.createElement(m.a,null,l.a.createElement(g,{label:"Almacenes:",size:"medium"})),l.a.createElement("br",null),l.a.createElement(m.a,{type:"flex",justify:"space-between"},this.WarehouseInputs()),l.a.createElement("br",null),l.a.createElement(m.a,null,this.saveItemButton()))}}]),t}(c.Component);a.default=Object(p.g)(Object(f.b)((function(e){var a=e.appUserReducer,t=e.warehouseReducer,n=e.measureReducer,r=a.idCompany,s=n.nameIdMeasureHashMap;return{idCompany:r,nameIdWarehouseHashMap:t.nameIdWarehouseHashMap,nameIdMeasureHashMap:s}}))(y))},769:function(e,a,t){}}]);
//# sourceMappingURL=59.1a89d77a.chunk.js.map